theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust=1, hjust=1, size=15)) +
ggtitle("") +
guide_italics+
theme(legend.title = element_text(size = 18),
legend.position="bottom",
legend.text=element_text(size=16),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
strip.text.x = element_text(size = 16),
axis.text = element_text(size = 15)) +
facet_wrap(~Species_italic+Strain_italic+Organ, scales = "free_x", ncol=3, labeller=label_parsed)+
labs(y="Sequence counts")+
ylim(0, 1000000)+
geom_text(aes(label=Read_depth), position=position_dodge(width=0.5), size=4, angle=90, hjust=-0.1, vjust=0.25)+
guides(fill=guide_legend(title="Oligotype"))
p
p2 <- ggplot(metadata_read_ovary, aes(x = Sample, y = Read_depth))+
geom_bar(position = "dodge", stat = "identity")+
scale_fill_manual(values = col)+
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust=1, hjust=1, size=15)) +
ggtitle("") +
guide_italics+
theme(legend.title = element_text(size = 18),
legend.position="bottom",
legend.text=element_text(size=16),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
strip.text.x = element_text(size = 16),
axis.text = element_text(size = 15)) +
facet_wrap(~Species_italic+Strain_italic+Organ, scales = "free_x", ncol=3, labeller=label_parsed)+
labs(y="Sequence counts")+
ylim(0, 1000000)+
geom_text(aes(label=Read_depth), position=position_dodge(width=0.5), size=4, angle=90, hjust=-0.1, vjust=0.25)+
guides(fill=guide_legend(title="Oligotype"))
p2
# panels
p_group <- plot_grid(p+theme(legend.position="none"),
p2+theme(legend.position="none"),
nrow=2,
ncol=1)+
draw_plot_label(c("A", "B"), c(0, 0), c(1, 0.5), size = 15)
legend_plot <- get_legend(p + theme(legend.position="bottom"))
p_counts <- plot_grid(p_group, legend_plot, nrow=2, ncol=1, rel_heights = c(1, .1))
p_counts
new_names_genus <- c("Wolbachia",
"Asaia",
"Legionella",
"Elizabethkingia",
"Chryseobacterium",
"Erwinia",
"Morganella",
"Pseudomonas",
"Delftia",
"Methylobacterium-Methylorubrum",
"Serratia",
"Coetzeea",
"NA"
)
col_genus <- c("Wolbachia"="#FEB24C",
"Asaia"="#10E015",
"Legionella"="#DE3F23",
"Elizabethkingia"="#66A7ED",
"Chryseobacterium"="#F899FF",
"Erwinia"="#FFE352",
"Morganella"="#F5E4D3",
"Pseudomonas"="#DBF5F0",
"Delftia"="#C7C5B7",
"Methylobacterium-Methylorubrum"="blue",
"Serratia"="#B136F5",
"Coetzeea"="red",
"NA"="grey")
p <- plot_bar(ps.filter, "Genus", "Abundance", "Genus")+
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
scale_fill_manual(values = col_genus)+
labs(x="Genus", y="Number of read") +
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)
p
# ps.filter2 <- ps.filter
# p = plot_bar(ps.filter2, x="Genus", y="Abundance", fill="Genus", facet_grid=~sample_Species+Strain+Organ)
# p + geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")
#
# levels(ps.filter2@sam_data$Species)= c("Aedes aegypti"=make.italic("Aedes aegypti"),
#                "Culex pipiens"=make.italic("Culex pipiens"),
#                "Culex quinquefasciatus"=make.italic("Culex quinquefasciatus"))
#
# levels(ps.filter2@sam_data$Strain) <- c("Bosc", "Camping~Europe", "Guadeloupe", "Lavar~(lab)", expression(paste(italic("Wolbachia"), "- (Slab TC)")))
#
#       test <- dataframe[dataframe$sample_Species==selection,] %>%
#         group_by({{variable}}, Genus) %>%
#         summarise(rel_ab = sum(Abundance))
#
#
# p = plot_bar(ps.filter2, x="Genus", y="Abundance", fill="Genus")
# p1 <- p +
#   geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
#   facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3, labeller=label_parsed)+
#     theme(legend.title = element_text(size = 20),
#         legend.position="bottom",
#         legend.text = element_text(size=14),
#         panel.spacing.y=unit(1, "lines"),
#         panel.spacing.x=unit(0.8, "lines"),
#         panel.spacing=unit(0,"lines"),
#         strip.background=element_rect(color="grey30", fill="grey90"),
#         strip.text.x = element_text(size = 16),
#         #panel.border=element_rect(color="grey90"),
#         axis.ticks.x=element_blank(),
#         axis.text.y = element_text(size=18))+
#   #geom_text(aes(label=Abundance),position=position_dodge(width=0.9), size=4, angle=90, hjust=-0.1, vjust=0.25)+
#   #geom_text(aes(label = signif(Abundance, digits = 3)), nudge_y = 4)+
#   labs(x="Sample", y="Number of reads", fill="Genus")
#
# setwd(path_plot)
# png("TEST.png", units="in", width=20, height=25, res=300)
# p1
# dev.off()
data <- p$data
labels = c("Wolbachia"=make.italic("Wolbachia"),
"Asaia"=make.italic("Asaia"),
"Legionella"=make.italic("Legionella"),
"Elizabethkingia"=make.italic("Elizabethkingia"),
"Chryseobacterium"=make.italic("Chryseobacterium"),
"Erwinia"=make.italic("Erwinia"),
"Morganella"=make.italic("Morganella"),
"Pseudomonas"=make.italic("Pseudomonas"),
"Delftia"=make.italic("Delftia"),
"Methylobacterium-Methylorubrum"=make.italic("Methylobacterium-Methylorubrum"),
"Serratia"=make.italic("Serratia"),
"Coetzeea"=make.italic("Coetzeea"),
"NA"
)
data_pipiens_whole <- data[data$sample_Species=="Culex pipiens" & data$Organ=="Whole",]
data_pipiens_ovary <- data[data$sample_Species=="Culex pipiens" & data$Organ=="Ovary",]
data_quinque_whole <- data[data$sample_Species=="Culex quinquefasciatus" & data$Organ=="Whole",]
data_quinque_ovary <- data[data$sample_Species=="Culex quinquefasciatus" & data$Organ=="Ovary",]
data_aedes_whole <- data[data$sample_Species=="Aedes aegypti" & data$Organ=="Whole",]
data_aedes_ovary <- data[data$sample_Species=="Aedes aegypti" & data$Organ=="Ovary",]
# pipiens
## whole
### all
pipiens1 <- percent_taxonomic_plot_test(data=data_pipiens_whole, variable=sample_Species, selection="Culex pipiens", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(subtitle= "Culex pipiens - Whole")+
theme(plot.tag.position = "topright",
plot.subtitle=element_text(size=10, face="italic", color="black"))
### field
pipiens2 <- percent_taxonomic_plot_test(data=data_pipiens_whole, variable=Strain, selection="Field - Bosc", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(subtitle = "Culex pipiens - Whole")+
theme(plot.tag.position = "topright",
plot.subtitle=element_text(size=10, face="italic", color="black"))
pipiens3 <- percent_taxonomic_plot_test(data=data_pipiens_whole, variable=Strain, selection="Field - Camping Europe", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(subtitle = "Culex pipiens - Whole")+
theme(plot.tag.position = "topright",
plot.subtitle=element_text(size=10, face="italic", color="black"))
### labo
pipiens4 <- percent_taxonomic_plot_test(data=data_pipiens_whole, variable=Strain, selection="Laboratory - Lavar", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(subtitle = "Culex pipiens - Whole")+
theme(plot.tag.position = "topright",
plot.subtitle=element_text(size=10, face="italic", color="black"))
## ovary
## all
pipiens5 <- percent_taxonomic_plot_test(data=data_pipiens_ovary, variable=sample_Species, selection="Culex pipiens", group="Genus", organ="Ovary", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(subtitle = "Culex pipiens - Ovary")+
theme(plot.tag.position = "topright",
plot.subtitle=element_text(size=10, face="italic", color="black"))
# quinque
## whole
### all
quinque1 <- percent_taxonomic_plot_test(data=data_quinque_whole, variable=sample_Species, selection="Culex quinquefasciatus", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(subtitle = "Culex quinquefasciatus - Whole")+
theme(plot.tag.position = "topright",
plot.subtitle=element_text(size=10, face="italic", color="black"))
### field
quinque2 <- percent_taxonomic_plot_test(data=data_quinque_whole, variable=Strain, selection="Field - Guadeloupe", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(subtitle = "Culex quinquefasciatus - Whole")+
theme(plot.tag.position = "topright",
plot.subtitle=element_text(size=10, face="italic", color="black"))
### labo
quinque3 <- percent_taxonomic_plot_test(data=data_quinque_whole, variable=Strain, selection="Laboratory - Slab TC (Wolbachia -)",group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(subtitle = "Culex quinquefasciatus - Whole")+
theme(plot.tag.position = "topright",
plot.subtitle=element_text(size=10, face="italic", color="black"))
quinque3[["labels"]][["title"]] <- expression(paste(italic("Wolbachia"), "- (Slab TC)"))
## ovary
## all
quinque4 <- percent_taxonomic_plot_test(data=data_quinque_ovary, variable=sample_Species, selection="Culex quinquefasciatus",group="Genus", organ="Ovary", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(subtitle = "Culex quinquefasciatus - Ovary")+
theme(plot.tag.position = "topright",
plot.subtitle=element_text(size=10, face="italic", color="black"))
# aedes
## whole
### all
aedes1 <- percent_taxonomic_plot_test(data=data_aedes_whole, variable=sample_Species, selection="Aedes aegypti",group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(subtitle = "Aedes aegypti - Whole")+
theme(plot.tag.position = "topright",
plot.subtitle=element_text(size=10, face="italic", color="black"))
## ovary
## all
aedes2 <- percent_taxonomic_plot_test(data=data_aedes_ovary, variable=sample_Species, selection="Aedes aegypti", group="Genus", organ="Ovary", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(subtitle = "Aedes aegypti - Ovary")+
theme(plot.tag.position = "topright",
plot.subtitle=element_text(size=10, face="italic", color="black"))
p_genus <- plot_grid(pipiens1+ theme(legend.position="none"),
pipiens2+ theme(legend.position="none"),
pipiens3+ theme(legend.position="none"),
pipiens4+ theme(legend.position="none"),
pipiens5+ theme(legend.position="none"),
quinque1+ theme(legend.position="none"),
quinque2+ theme(legend.position="none"),
quinque3+ theme(legend.position="none"),
quinque4+ theme(legend.position="none"),
plot.new(),
aedes1+ theme(legend.position="none"),
aedes2+ theme(legend.position="none"),
plot.new(),
plot.new(),
plot.new(),
nrow=3,
ncol=5)
# +
#   draw_plot_label(c("A", "B", "C"), c(0, 0, 0), c(1, 2/3, 1/3), size = 15)
p_genus
x <- c("Culex pipiens", "Field - Bosc", "Field - Camping Europe", "Laboratory - Lavar",
"Culex quinquefasciatus", "Field - Guadeloupe", "Laboratory - Slab TC (Wolbachia -)",
"Aedes aegypti (Guadeloupe)",
"Total")
y <- c("Reads", "Oligotypes", "Samples")
df <- data.frame(matrix(ncol=3, nrow=9))
rownames(df) <- x
colnames(df) <- y
df2 <- df
df3 <- df
# Culex pipiens
ps.pipiens <- subset_samples(ps.filter, Species=="Culex pipiens")
ps.pipiens <- check_ps(ps.pipiens)
## All Strain
### oligotype
nrow(ps.pipiens@otu_table) -> df["Culex pipiens", "Oligotypes"]
### samples
nrow(ps.pipiens@sam_data) -> df["Culex pipiens", "Samples"]
### reads
compute_read_counts(ps.pipiens) -> df["Culex pipiens", "Reads"]
## Bosc
### oligotype
nrow(otu_table(ps.pipiens %>%
subset_samples(Strain=="Field - Bosc") %>%
check_ps())) -> df["Field - Bosc", "Oligotypes"]
### samples
nrow(ps.pipiens@sam_data %>% subset_samples(Strain=="Field - Bosc")) -> df["Field - Bosc", "Samples"]
### reads
compute_read_counts(ps.pipiens %>% subset_samples(Strain=="Field - Bosc")) -> df["Field - Bosc", "Reads"]
## Camping Europe
### oligotype
nrow(otu_table(ps.pipiens %>%
subset_samples(Strain=="Field - Camping Europe") %>%
check_ps())) -> df["Field - Camping Europe", "Oligotypes"]
### samples
nrow(ps.pipiens@sam_data %>% subset_samples(Strain=="Field - Camping Europe")) -> df["Field - Camping Europe", "Samples"]
### reads
compute_read_counts(ps.pipiens %>% subset_samples(Strain=="Field - Camping Europe")) -> df["Field - Camping Europe", "Reads"]
## Lavar (labo)
### oligotype
nrow(otu_table(ps.pipiens %>%
subset_samples(Strain=="Laboratory - Lavar") %>%
check_ps())) -> df["Laboratory - Lavar", "Oligotypes"]
### samples
nrow(ps.pipiens@sam_data %>% subset_samples(Strain=="Laboratory - Lavar")) -> df["Laboratory - Lavar", "Samples"]
### reads
compute_read_counts(ps.pipiens %>% subset_samples(Strain=="Laboratory - Lavar")) -> df["Laboratory - Lavar", "Reads"]
# Culex quinquefasciatus
ps.quinque <- subset_samples(ps.filter, Species=="Culex quinquefasciatus")
ps.quinque <- check_ps(ps.quinque)
## All Strain
### oligotype
nrow(ps.quinque@otu_table) -> df["Culex quinquefasciatus", "Oligotypes"]
### samples
nrow(ps.quinque@sam_data) -> df["Culex quinquefasciatus", "Samples"]
### reads
compute_read_counts(ps.quinque) -> df["Culex quinquefasciatus", "Reads"]
## Guadeloupe
### oligotype
nrow(otu_table(ps.quinque %>%
subset_samples(Strain=="Field - Guadeloupe") %>%
check_ps())) -> df["Field - Guadeloupe", "Oligotypes"]
### samples
nrow(ps.quinque@sam_data %>% subset_samples(Strain=="Field - Guadeloupe")) -> df["Field - Guadeloupe", "Samples"]
### reads
compute_read_counts(ps.quinque %>% subset_samples(Strain=="Field - Guadeloupe")) -> df["Field - Guadeloupe", "Reads"]
## Wolbachia -
### oligotype
nrow(otu_table(ps.quinque %>%
subset_samples(Strain=="Laboratory - Slab TC (Wolbachia -)") %>%
check_ps())) -> df["Laboratory - Slab TC (Wolbachia -)", "Oligotypes"]
### samples
nrow(ps.quinque@sam_data %>% subset_samples(Strain=="Laboratory - Slab TC (Wolbachia -)")) -> df["Laboratory - Slab TC (Wolbachia -)", "Samples"]
### reads
compute_read_counts(ps.quinque %>% subset_samples(Strain=="Laboratory - Slab TC (Wolbachia -)")) -> df["Laboratory - Slab TC (Wolbachia -)", "Reads"]
# Aedes aegypti
ps.aedes <- subset_samples(ps.filter, Species=="Aedes aegypti")
ps.aedes <- check_ps(ps.aedes)
## Guadeloupe
### oligotype
nrow(otu_table(ps.aedes %>%
subset_samples(Strain=="Field - Guadeloupe") %>%
check_ps())) -> df["Aedes aegypti (Guadeloupe)", "Oligotypes"]
### samples
nrow(ps.aedes@sam_data %>% subset_samples(Strain=="Field - Guadeloupe")) -> df["Aedes aegypti (Guadeloupe)", "Samples"]
### reads
compute_read_counts(ps.aedes %>% subset_samples(Strain=="Field - Guadeloupe")) -> df["Aedes aegypti (Guadeloupe)", "Reads"]
# Total
### oligotype
nrow(ps.filter@otu_table) -> df["Total", "Oligotypes"]
### samples
nrow(ps.filter@sam_data) -> df["Total", "Samples"]
### reads
compute_read_counts(ps.filter) -> df["Total", "Reads"]
df %>%
kbl() %>%
kable_paper("hover", full_width = F)
# Culex pipiens
ps.pipiens.whole <- ps.pipiens %>% subset_samples(Organ=="Whole")
ps.pipiens.whole <- ps.pipiens.whole %>% check_ps()
## All Strain
### oligotype
nrow(ps.pipiens.whole@otu_table) -> df2["Culex pipiens", "Oligotypes"]
### samples
nrow(ps.pipiens.whole@sam_data) -> df2["Culex pipiens", "Samples"]
### reads
compute_read_counts(ps.pipiens.whole) -> df2["Culex pipiens", "Reads"]
## Bosc
### oligotype
nrow(otu_table(ps.pipiens.whole %>%
subset_samples(Strain=="Field - Bosc") %>%
check_ps())) -> df2["Field - Bosc", "Oligotypes"]
### samples
nrow(ps.pipiens.whole@sam_data %>% subset_samples(Strain=="Field - Bosc")) -> df2["Field - Bosc", "Samples"]
### reads
compute_read_counts(ps.pipiens.whole %>% subset_samples(Strain=="Field - Bosc")) -> df2["Field - Bosc", "Reads"]
## Camping Europe
### oligotype
nrow(otu_table(ps.pipiens.whole %>%
subset_samples(Strain=="Field - Camping Europe") %>%
check_ps())) -> df2["Field - Camping Europe", "Oligotypes"]
### samples
nrow(ps.pipiens.whole@sam_data %>% subset_samples(Strain=="Field - Camping Europe")) -> df2["Field - Camping Europe", "Samples"]
### reads
compute_read_counts(ps.pipiens.whole %>% subset_samples(Strain=="Field - Camping Europe")) -> df2["Field - Camping Europe", "Reads"]
## Lavar (labo)
### oligotype
nrow(otu_table(ps.pipiens.whole %>%
subset_samples(Strain=="Laboratory - Lavar") %>%
check_ps())) -> df2["Laboratory - Lavar", "Oligotypes"]
### samples
nrow(ps.pipiens.whole@sam_data %>% subset_samples(Strain=="Laboratory - Lavar")) -> df2["Laboratory - Lavar", "Samples"]
### reads
compute_read_counts(ps.pipiens.whole %>% subset_samples(Strain=="Laboratory - Lavar")) -> df2["Laboratory - Lavar", "Reads"]
# Culex quinquefasciatus
ps.quinque.whole <- subset_samples(ps.quinque, Organ=="Whole")
ps.quinque.whole <- check_ps(ps.quinque.whole)
## All Strain
### oligotype
nrow(ps.quinque.whole@otu_table) -> df2["Culex quinquefasciatus", "Oligotypes"]
### samples
nrow(ps.quinque.whole@sam_data) -> df2["Culex quinquefasciatus", "Samples"]
### reads
compute_read_counts(ps.quinque.whole) -> df2["Culex quinquefasciatus", "Reads"]
## Guadeloupe
### oligotype
nrow(otu_table(ps.quinque.whole %>%
subset_samples(Strain=="Field - Guadeloupe") %>%
check_ps())) -> df2["Field - Guadeloupe", "Oligotypes"]
### samples
nrow(ps.quinque.whole@sam_data %>% subset_samples(Strain=="Field - Guadeloupe")) -> df2["Field - Guadeloupe", "Samples"]
### reads
compute_read_counts(ps.quinque.whole %>% subset_samples(Strain=="Field - Guadeloupe")) -> df2["Field - Guadeloupe", "Reads"]
## Wolbachia -
### oligotype
nrow(otu_table(ps.quinque.whole %>%
subset_samples(Strain=="Laboratory - Slab TC (Wolbachia -)") %>%
check_ps())) -> df2["Laboratory - Slab TC (Wolbachia -)", "Oligotypes"]
### samples
nrow(ps.quinque.whole@sam_data %>% subset_samples(Strain=="Laboratory - Slab TC (Wolbachia -)")) -> df2["Laboratory - Slab TC (Wolbachia -)", "Samples"]
### reads
compute_read_counts(ps.quinque.whole %>% subset_samples(Strain=="Laboratory - Slab TC (Wolbachia -)")) -> df2["Laboratory - Slab TC (Wolbachia -)", "Reads"]
# Aedes aegypti
ps.aedes.whole <- subset_samples(ps.aedes, Organ=="Whole")
ps.aedes.whole <- check_ps(ps.aedes.whole)
## Guadeloupe
### oligotype
nrow(otu_table(ps.aedes.whole %>%
subset_samples(Strain=="Field - Guadeloupe") %>%
check_ps())) -> df2["Aedes aegypti (Guadeloupe)", "Oligotypes"]
### samples
nrow(ps.aedes.whole@sam_data %>% subset_samples(Strain=="Field - Guadeloupe")) -> df2["Aedes aegypti (Guadeloupe)", "Samples"]
### reads
compute_read_counts(ps.aedes.whole %>% subset_samples(Strain=="Field - Guadeloupe")) -> df2["Aedes aegypti (Guadeloupe)", "Reads"]
# Total
ps.whole <- ps.filter %>% subset_samples(Organ=="Whole")
ps.whole <- ps.whole %>% check_ps()
### oligotype
nrow(ps.whole@otu_table) -> df2["Total", "Oligotypes"]
### samples
nrow(ps.whole@sam_data) -> df2["Total", "Samples"]
### reads
compute_read_counts(ps.whole) -> df2["Total", "Reads"]
df2 %>%
kbl() %>%
kable_paper("hover", full_width = F)
# Culex pipiens
ps.pipiens.ovary <- ps.pipiens %>% subset_samples(Organ=="Ovary")
ps.pipiens.ovary <- ps.pipiens.ovary %>% check_ps()
## All Strain
### oligotype
nrow(ps.pipiens.ovary@otu_table) -> df3["Culex pipiens", "Oligotypes"]
### samples
nrow(ps.pipiens.ovary@sam_data) -> df3["Culex pipiens", "Samples"]
### reads
compute_read_counts(ps.pipiens.ovary) -> df3["Culex pipiens", "Reads"]
## Bosc
### oligotype
nrow(otu_table(ps.pipiens.ovary %>%
subset_samples(Strain=="Field - Bosc") %>%
check_ps())) -> df3["Field - Bosc", "Oligotypes"]
### samples
nrow(ps.pipiens.ovary@sam_data %>% subset_samples(Strain=="Field - Bosc")) -> df3["Field - Bosc", "Samples"]
### reads
compute_read_counts(ps.pipiens.ovary %>% subset_samples(Strain=="Field - Bosc")) -> df3["Field - Bosc", "Reads"]
## Camping Europe
### oligotype
nrow(otu_table(ps.pipiens.ovary %>%
subset_samples(Strain=="Field - Camping Europe") %>%
check_ps())) -> df3["Field - Camping Europe", "Oligotypes"]
### samples
nrow(ps.pipiens.ovary@sam_data %>% subset_samples(Strain=="Field - Camping Europe")) -> df3["Field - Camping Europe", "Samples"]
### reads
compute_read_counts(ps.pipiens.ovary %>% subset_samples(Strain=="Field - Camping Europe")) -> df3["Field - Camping Europe", "Reads"]
## Lavar (labo)
### oligotype
nrow(otu_table(ps.pipiens.ovary %>%
subset_samples(Strain=="Laboratory - Lavar") %>%
check_ps())) -> df3["Laboratory - Lavar", "Oligotypes"]
### samples
nrow(ps.pipiens.ovary@sam_data %>% subset_samples(Strain=="Laboratory - Lavar")) -> df3["Laboratory - Lavar", "Samples"]
### reads
compute_read_counts(ps.pipiens.ovary %>% subset_samples(Strain=="Laboratory - Lavar")) -> df3["Laboratory - Lavar", "Reads"]
# Culex quinquefasciatus
ps.quinque.ovary <- subset_samples(ps.quinque, Organ=="Ovary")
ps.quinque.ovary <- check_ps(ps.quinque.ovary)
## All Strain
### oligotype
nrow(ps.quinque.ovary@otu_table) -> df3["Culex quinquefasciatus", "Oligotypes"]
### samples
nrow(ps.quinque.ovary@sam_data) -> df3["Culex quinquefasciatus", "Samples"]
### reads
compute_read_counts(ps.quinque.ovary) -> df3["Culex quinquefasciatus", "Reads"]
## Guadeloupe
### oligotype
nrow(otu_table(ps.quinque.ovary %>%
subset_samples(Strain=="Field - Guadeloupe") %>%
check_ps())) -> df3["Field - Guadeloupe", "Oligotypes"]
### samples
nrow(ps.quinque.ovary@sam_data %>% subset_samples(Strain=="Field - Guadeloupe")) -> df3["Field - Guadeloupe", "Samples"]
### reads
compute_read_counts(ps.quinque.ovary %>% subset_samples(Strain=="Field - Guadeloupe")) -> df3["Field - Guadeloupe", "Reads"]
## Wolbachia -
### oligotype
# nrow(otu_table(ps.quinque.ovary %>%
#                  subset_samples(Strain=="Laboratory - Slab TC (Wolbachia -)") %>%
#                  check_ps())) -> df3["Laboratory - Slab TC (Wolbachia -)", "Oligotypes"]
### samples
# nrow(ps.quinque.ovary@sam_data %>% subset_samples(Strain=="Laboratory - Slab TC (Wolbachia -)")) -> df3["Laboratory - Slab TC (Wolbachia -)", "Samples"]
# ### reads
# compute_read_counts(ps.quinque.ovary %>% subset_samples(Strain=="Laboratory - Slab TC (Wolbachia -)")) -> df3["Laboratory - Slab TC (Wolbachia -)", "Reads"]
# Aedes aegypti
ps.aedes.ovary <- subset_samples(ps.aedes, Organ=="Ovary")
ps.aedes.ovary <- check_ps(ps.aedes.ovary)
## Guadeloupe
### oligotype
nrow(otu_table(ps.aedes.ovary %>%
subset_samples(Strain=="Field - Guadeloupe") %>%
check_ps())) -> df3["Aedes aegypti (Guadeloupe)", "Oligotypes"]
### samples
nrow(ps.aedes.ovary@sam_data %>% subset_samples(Strain=="Field - Guadeloupe")) -> df3["Aedes aegypti (Guadeloupe)", "Samples"]
### reads
compute_read_counts(ps.aedes.ovary %>% subset_samples(Strain=="Field - Guadeloupe")) -> df3["Aedes aegypti (Guadeloupe)", "Reads"]
# Total
ps.ovary <- ps.filter %>% subset_samples(Organ=="Ovary")
ps.ovary <- ps.ovary %>% check_ps()
### oligotype
nrow(ps.ovary@otu_table) -> df3["Total", "Oligotypes"]
### samples
nrow(ps.ovary@sam_data) -> df3["Total", "Samples"]
### reads
compute_read_counts(ps.ovary) -> df3["Total", "Reads"]
df3[is.na(df3)] <- 0
df3 %>%
kbl() %>%
kable_paper("hover", full_width = F)
change_organ(ps.filter)
change_species(ps.filter)
View(ps.filter)
ps.filter@refseq@ranges@width
ps.filter@refseq@ranges@start
ps.filter@refseq@ranges@NAMES
