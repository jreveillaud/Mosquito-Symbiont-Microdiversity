draw_plot_label(c("A", "B", "C"), c(0, 0, 0), c(1, 2/3, 1/3), size = 15)
p_genus
new_names_genus <- c("Wolbachia",
"Asaia",
"Legionella",
"Elizabethkingia",
"Chryseobacterium",
"Erwinia",
"Morganella",
"Pseudomonas",
"Delftia",
"Methylobacterium-Methylorubrum",
"Serratia",
"Coetzeea",
"NA"
)
col_genus <- c("Wolbachia"="#FEB24C",
"Asaia"="#10E015",
"Legionella"="#DE3F23",
"Elizabethkingia"="#66A7ED",
"Chryseobacterium"="#F899FF",
"Erwinia"="#FFE352",
"Morganella"="#F5E4D3",
"Pseudomonas"="#DBF5F0",
"Delftia"="#C7C5B7",
"Methylobacterium-Methylorubrum"="blue",
"Serratia"="#B136F5",
"Coetzeea"="red",
"NA"="grey")
p <- plot_bar(ps.filter, "Genus", "Abundance", "Genus")+
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
scale_fill_manual(values = col_genus)+
labs(x="Genus", y="Number of read") +
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)
p
p = plot_bar(ps.filter, "Genus", fill="Genus", facet_grid=sample_Species+Strain+Organ)
View(ps.filter)
p <- plot_bar(ps.filter, "Genus", "Abundance", "Genus")+
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
scale_fill_manual(values = col_genus)+
labs(x="Genus", y="Number of read") +
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)
p
p = plot_bar(ps.filter, x="Genus", y="Abundance", fill="Genus", facet_grid=sample_Species+Strain+Organ)
p = plot_bar(ps.filter, x="Genus", y="Abundance", fill="Genus", facet_grid=Species+Strain+Organ)
View(ps.filter)
data_filter <- data.frame(ps.filter@sam_data)
p = plot_bar(ps.filter, x="Genus", y="Abundance", fill="Genus", facet_grid=~sample_Species+Strain+Organ)
p + geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")
p = plot_bar(ps.filter, x="Genus", y="Abundance", fill="Genus", facet_wrap=~sample_Species+Strain+Organ)
p = plot_bar(ps.filter, x="Genus", y="Abundance", fill="Genus", facet_grid=~sample_Species+Strain+Organ)
p + geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")
p = plot_bar(ps.filter, x="Genus", y="Abundance", fill="Genus")
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
#legend.key.height = unit(1, 'cm'),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
axis.text.y = element_text(size=18))
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14))
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"))
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"))
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"))
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16))
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
panel.border=element_rect(color="grey90"))
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
#panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
axis.text.y = element_text(size=18))
ps.filter2 <- ps.filter
levels(ps.filter2@sam_data$Sample)= c("Aedes aegypti"=make.italic("Aedes aegypti"),
"Culex pipiens"=make.italic("Culex pipiens"),
"Culex quinquefasciatus"=make.italic("Culex quinquefasciatus"))
levels(ps.filter2@sam_data$Sample)
levels(ps.filter2@sam_data$Species)
levels(ps.filter2@sam_data$Species)= c("Aedes aegypti"=make.italic("Aedes aegypti"),
"Culex pipiens"=make.italic("Culex pipiens"),
"Culex quinquefasciatus"=make.italic("Culex quinquefasciatus"))
levels(ps.filter2@sam_data$Location)
View(ps.filter2)
levels(ps.filter2@sam_data$Strain)
levels(ps.filter2@sam_data$Strain) <- c("Bosc", "Camping~Europe", "Guadeloupe", "Lavar~(lab)", expression(paste(italic("Wolbachia"), "- (Slab TC)")))
p = plot_bar(ps.filter2, x="Genus", y="Abundance", fill="Genus")
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
#panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
axis.text.y = element_text(size=18))
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3, labeller=label_parsed)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
#panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
axis.text.y = element_text(size=18))
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3, labeller=label_parsed)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
#panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
axis.text.y = element_text(size=18))+
labs(x="Sample", y="Number of reads", fill="Genus")
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3, labeller=label_parsed)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
#panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
axis.text.y = element_text(size=18))+
geom_text(aes(label=Abundance),position=position_dodge(width=0.9), size=4, angle=90, hjust=-0.1, vjust=0.25)+
labs(x="Sample", y="Number of reads", fill="Genus")
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3, labeller=label_parsed)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
#panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
axis.text.y = element_text(size=18))+
#geom_text(aes(label=Abundance),position=position_dodge(width=0.9), size=4, angle=90, hjust=-0.1, vjust=0.25)+
geom_text(aes(label = signif(ave_lifeExp, digits = 3)), nudge_y = 4)+
labs(x="Sample", y="Number of reads", fill="Genus")
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3, labeller=label_parsed)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
#panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
axis.text.y = element_text(size=18))+
#geom_text(aes(label=Abundance),position=position_dodge(width=0.9), size=4, angle=90, hjust=-0.1, vjust=0.25)+
geom_text(aes(label = signif(Abundance, digits = 3)), nudge_y = 4)+
labs(x="Sample", y="Number of reads", fill="Genus")
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3, labeller=label_parsed)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
#panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
axis.text.y = element_text(size=18))+
#geom_text(aes(label=Abundance),position=position_dodge(width=0.9), size=4, angle=90, hjust=-0.1, vjust=0.25)+
geom_text(aes(label = signif(Abundance, digits = 3)), nudge_y = 4)+
labs(x="Sample", y="Number of reads", fill="Genus")
p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3, labeller=label_parsed)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
#panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
axis.text.y = element_text(size=18))+
#geom_text(aes(label=Abundance),position=position_dodge(width=0.9), size=4, angle=90, hjust=-0.1, vjust=0.25)+
#geom_text(aes(label = signif(Abundance, digits = 3)), nudge_y = 4)+
labs(x="Sample", y="Number of reads", fill="Genus")
setwd(path_tsv)
write.table(p, "TEST.tsv", sep="\t", row.names = TRUE, col.names=NA)
setwd(path_plot)
png("TEST.png", units="in", width=20, height=18, res=300)
p
dev.off()
p1 <- p +
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3, labeller=label_parsed)+
theme(legend.title = element_text(size = 20),
legend.position="bottom",
legend.text = element_text(size=14),
panel.spacing.y=unit(1, "lines"),
panel.spacing.x=unit(0.8, "lines"),
panel.spacing=unit(0,"lines"),
strip.background=element_rect(color="grey30", fill="grey90"),
strip.text.x = element_text(size = 16),
#panel.border=element_rect(color="grey90"),
axis.ticks.x=element_blank(),
axis.text.y = element_text(size=18))+
#geom_text(aes(label=Abundance),position=position_dodge(width=0.9), size=4, angle=90, hjust=-0.1, vjust=0.25)+
#geom_text(aes(label = signif(Abundance, digits = 3)), nudge_y = 4)+
labs(x="Sample", y="Number of reads", fill="Genus")
setwd(path_plot)
png("TEST.png", units="in", width=20, height=18, res=300)
p1
dev.off()
setwd(path_plot)
png("TEST.png", units="in", width=20, height=25, res=300)
p1
dev.off()
View(ps.filter2)
data <- p$data
labels = c("Wolbachia"=make.italic("Wolbachia"),
"Asaia"=make.italic("Asaia"),
"Legionella"=make.italic("Legionella"),
"Elizabethkingia"=make.italic("Elizabethkingia"),
"Chryseobacterium"=make.italic("Chryseobacterium"),
"Erwinia"=make.italic("Erwinia"),
"Morganella"=make.italic("Morganella"),
"Pseudomonas"=make.italic("Pseudomonas"),
"Delftia"=make.italic("Delftia"),
"Methylobacterium-Methylorubrum"=make.italic("Methylobacterium-Methylorubrum"),
"Serratia"=make.italic("Serratia"),
"Coetzeea"=make.italic("Coetzeea"),
"NA"
)
data_pipiens_whole <- data[data$sample_Species=="Culex pipiens" & data$Organ=="Whole",]
data_pipiens_ovary <- data[data$sample_Species=="Culex pipiens" & data$Organ=="Ovary",]
data_quinque_whole <- data[data$sample_Species=="Culex quinquefasciatus" & data$Organ=="Whole",]
data_quinque_ovary <- data[data$sample_Species=="Culex quinquefasciatus" & data$Organ=="Ovary",]
data_aedes_whole <- data[data$sample_Species=="Aedes aegypti" & data$Organ=="Whole",]
data_aedes_ovary <- data[data$sample_Species=="Aedes aegypti" & data$Organ=="Ovary",]
# pipiens
## whole
### all
pipiens1 <- percent_taxonomic_plot_test(data=data_pipiens_whole, variable=sample_Species, selection="Culex pipiens", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(Culex pipiens - Whole)")+
theme(plot.tag.position = "topright")
### field
pipiens2 <- percent_taxonomic_plot_test(data=data_pipiens_whole, variable=Strain, selection="Field - Bosc", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(W)")+
theme(plot.tag.position = "topright")
pipiens3 <- percent_taxonomic_plot_test(data=data_pipiens_whole, variable=Strain, selection="Field - Camping Europe", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(W)")+
theme(plot.tag.position = "topright")
### labo
pipiens4 <- percent_taxonomic_plot_test(data=data_pipiens_whole, variable=Strain, selection="Laboratory - Lavar", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(W)")+
theme(plot.tag.position = "topright")
## ovary
## all
pipiens5 <- percent_taxonomic_plot_test(data=data_pipiens_ovary, variable=sample_Species, selection="Culex pipiens", group="Genus", organ="Ovary", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(O)")+
theme(plot.tag.position = "topright")
# quinque
## whole
### all
quinque1 <- percent_taxonomic_plot_test(data=data_quinque_whole, variable=sample_Species, selection="Culex quinquefasciatus", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(W)")+
theme(plot.tag.position = "topright")
### field
quinque2 <- percent_taxonomic_plot_test(data=data_quinque_whole, variable=Strain, selection="Field - Guadeloupe", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(W)")+
theme(plot.tag.position = "topright")
### labo
quinque3 <- percent_taxonomic_plot_test(data=data_quinque_whole, variable=Strain, selection="Laboratory - Slab TC (Wolbachia -)",group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(W)")+
theme(plot.tag.position = "topright")
quinque3[["labels"]][["title"]] <- expression(paste(italic("Wolbachia"), "- (Slab TC)"))
## ovary
## all
quinque4 <- percent_taxonomic_plot_test(data=data_quinque_ovary, variable=sample_Species, selection="Culex quinquefasciatus",group="Genus", organ="Ovary", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(O)")+
theme(plot.tag.position = "topright")
# aedes
## whole
### all
aedes1 <- percent_taxonomic_plot_test(data=data_aedes_whole, variable=sample_Species, selection="Aedes aegypti",group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(W)")+
theme(plot.tag.position = "topright")
## ovary
## all
aedes2 <- percent_taxonomic_plot_test(data=data_aedes_ovary, variable=sample_Species, selection="Aedes aegypti", group="Genus", organ="Ovary", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(O)")+
theme(plot.tag.position = "topright")
p_genus <- plot_grid(pipiens1+ theme(legend.position="none"),
pipiens2+ theme(legend.position="none"),
pipiens3+ theme(legend.position="none"),
pipiens4+ theme(legend.position="none"),
pipiens5+ theme(legend.position="none"),
quinque1+ theme(legend.position="none"),
quinque2+ theme(legend.position="none"),
quinque3+ theme(legend.position="none"),
quinque4+ theme(legend.position="none"),
plot.new(),
aedes1+ theme(legend.position="none"),
aedes2+ theme(legend.position="none"),
plot.new(),
plot.new(),
plot.new(),
nrow=3,
ncol=5)+
draw_plot_label(c("A", "B", "C"), c(0, 0, 0), c(1, 2/3, 1/3), size = 15)
pipiens1
# pipiens
## whole
### all
pipiens1 <- percent_taxonomic_plot_test(data=data_pipiens_whole, variable=sample_Species, selection="Culex pipiens", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(W)")+
theme(plot.tag.position = "topright")
pipiens1
new_names_genus <- c("Wolbachia",
"Asaia",
"Legionella",
"Elizabethkingia",
"Chryseobacterium",
"Erwinia",
"Morganella",
"Pseudomonas",
"Delftia",
"Methylobacterium-Methylorubrum",
"Serratia",
"Coetzeea",
"NA"
)
col_genus <- c("Wolbachia"="#FEB24C",
"Asaia"="#10E015",
"Legionella"="#DE3F23",
"Elizabethkingia"="#66A7ED",
"Chryseobacterium"="#F899FF",
"Erwinia"="#FFE352",
"Morganella"="#F5E4D3",
"Pseudomonas"="#DBF5F0",
"Delftia"="#C7C5B7",
"Methylobacterium-Methylorubrum"="blue",
"Serratia"="#B136F5",
"Coetzeea"="red",
"NA"="grey")
p <- plot_bar(ps.filter, "Genus", "Abundance", "Genus")+
geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
scale_fill_manual(values = col_genus)+
labs(x="Genus", y="Number of read") +
facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3)
p
# ps.filter2 <- ps.filter
# p = plot_bar(ps.filter2, x="Genus", y="Abundance", fill="Genus", facet_grid=~sample_Species+Strain+Organ)
# p + geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")
#
# levels(ps.filter2@sam_data$Species)= c("Aedes aegypti"=make.italic("Aedes aegypti"),
#                "Culex pipiens"=make.italic("Culex pipiens"),
#                "Culex quinquefasciatus"=make.italic("Culex quinquefasciatus"))
#
# levels(ps.filter2@sam_data$Strain) <- c("Bosc", "Camping~Europe", "Guadeloupe", "Lavar~(lab)", expression(paste(italic("Wolbachia"), "- (Slab TC)")))
#
#       test <- dataframe[dataframe$sample_Species==selection,] %>%
#         group_by({{variable}}, Genus) %>%
#         summarise(rel_ab = sum(Abundance))
#
#
# p = plot_bar(ps.filter2, x="Genus", y="Abundance", fill="Genus")
# p1 <- p +
#   geom_bar(aes(color=Genus, fill=Genus), stat="identity", position="stack")+
#   facet_wrap(~sample_Species+Strain+Organ, scales = "free", ncol=3, labeller=label_parsed)+
#     theme(legend.title = element_text(size = 20),
#         legend.position="bottom",
#         legend.text = element_text(size=14),
#         panel.spacing.y=unit(1, "lines"),
#         panel.spacing.x=unit(0.8, "lines"),
#         panel.spacing=unit(0,"lines"),
#         strip.background=element_rect(color="grey30", fill="grey90"),
#         strip.text.x = element_text(size = 16),
#         #panel.border=element_rect(color="grey90"),
#         axis.ticks.x=element_blank(),
#         axis.text.y = element_text(size=18))+
#   #geom_text(aes(label=Abundance),position=position_dodge(width=0.9), size=4, angle=90, hjust=-0.1, vjust=0.25)+
#   #geom_text(aes(label = signif(Abundance, digits = 3)), nudge_y = 4)+
#   labs(x="Sample", y="Number of reads", fill="Genus")
#
# setwd(path_plot)
# png("TEST.png", units="in", width=20, height=25, res=300)
# p1
# dev.off()
data <- p$data
labels = c("Wolbachia"=make.italic("Wolbachia"),
"Asaia"=make.italic("Asaia"),
"Legionella"=make.italic("Legionella"),
"Elizabethkingia"=make.italic("Elizabethkingia"),
"Chryseobacterium"=make.italic("Chryseobacterium"),
"Erwinia"=make.italic("Erwinia"),
"Morganella"=make.italic("Morganella"),
"Pseudomonas"=make.italic("Pseudomonas"),
"Delftia"=make.italic("Delftia"),
"Methylobacterium-Methylorubrum"=make.italic("Methylobacterium-Methylorubrum"),
"Serratia"=make.italic("Serratia"),
"Coetzeea"=make.italic("Coetzeea"),
"NA"
)
data_pipiens_whole <- data[data$sample_Species=="Culex pipiens" & data$Organ=="Whole",]
data_pipiens_ovary <- data[data$sample_Species=="Culex pipiens" & data$Organ=="Ovary",]
data_quinque_whole <- data[data$sample_Species=="Culex quinquefasciatus" & data$Organ=="Whole",]
data_quinque_ovary <- data[data$sample_Species=="Culex quinquefasciatus" & data$Organ=="Ovary",]
data_aedes_whole <- data[data$sample_Species=="Aedes aegypti" & data$Organ=="Whole",]
data_aedes_ovary <- data[data$sample_Species=="Aedes aegypti" & data$Organ=="Ovary",]
# pipiens
## whole
### all
pipiens1 <- percent_taxonomic_plot_test(data=data_pipiens_whole, variable=sample_Species, selection="Culex pipiens", group="Genus", organ="Whole", new_names=new_names_genus, col=col_genus, mylabels=labels)+
labs(tag = "(Culex pipiens - Whole)")+
theme(plot.tag.position = "topright")
pipiens1
